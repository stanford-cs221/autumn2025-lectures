{
  "files": {
    "gibbs_sampling.py": "from edtrace import text, image\nfrom typing import Callable\nfrom collections import defaultdict\nfrom random import random\nfrom bayes import ProbTable, Bernoulli\nfrom util import sample_dict, normalize_dict, set_random_seed\nfrom einops import einsum\n\ndef main():\n    text(\"### Lecture 13: Gibbs sampling\")\n\n    text(\"Last time: Bayesian networks, rejection sampling\")\n    text(\"This time: faster probabilistic inference methods (Gibbs sampling) + conditional independence\")\n\n    review_bayesian_networks()\n    introduce_gibbs_sampling()\n    introduce_conditional_independence()\n\n    text(\"Summary:\")\n    text(\"- Exact probabilistic inference: form the joint distribution and marginalize/condition (einops)\")\n    text(\"- Approximate probabilistic inference: rejection sampling, Gibbs sampling\")\n    text(\"- Conditional independence: determine whether two variables are independent given evidence?\")\n\n    text(\"Next time: learning parameters of Bayesian networks\")\n\n\ndef review_bayesian_networks():\n    text(\"**Joint distribution**: like a database that specifies how the world works\")\n    text(\"1. Define a set of random variables: X = (X_1, ..., X_n)\")\n    text(\"Example: B(urglary), E(arthquake), A(larm)\")\n\n    text(\"2. Define a directed acyclic graph (DAG) over the variables\")\n    text(\"Example: B \u2192 A, E \u2192 A\")\n    image(\"images/alarm-bayes.png\", width=200)\n\n    text(\"3. For each node, define a local conditional distribution: p(x_i | parents(x_i)).\")\n    text(\"Example: p(b), p(e), p(a | b, e)\")\n    p_b = ProbTable(\"B\", [0.95, 0.05]) # p(b) @inspect p_b @stepover\n    p_e = ProbTable(\"E\", [0.95, 0.05]) # p(e) @inspect p_e @stepover\n    p_a_given_be = ProbTable(\"A | B E\", lambda b, e, a: a == (b or e), shape=(2, 2, 2)) # p(a | b, e) @inspect p_a_given_be @stepover\n\n    text(\"4. Define the joint distribution: P(X_1, ..., X_n) = \u03a0_i p(x_i | parents(x_i))\")\n    text(\"Example: P(B, E, A) = p(b) p(e) p(a | b, e)\")\n    P_BEA = ProbTable(\"B E A\", einsum(p_b.p, p_e.p, p_a_given_be.p, \"b, e, b e a -> b e a\"))  # P(B, E, A) @inspect P_BEA @stepover\n\n    text(\"**Probabilistic inference**: answer questions (like SQL) on the joint distribution\")  # @clear p_b p_e p_a_given_be\n    text(\"Example: P(B | A = 1)\")\n    P_BEA1 = ProbTable(\"B E A=1\", P_BEA.p[:, :, 1])  # Condition on evidence: P(B, E, A = 1) @inspect P_BEA1 @stepover\n    P_BA1 = ProbTable(\"B A=1\", einsum(P_BEA1.p, \"b e -> b\"))  # Marginalize out other variables: P(B, A = 1) @inspect P_BA1 @stepover\n    P_A1 = ProbTable(\"A=1\", einsum(P_BA1.p, \"b ->\"))  # Probability of evidence: P(A = 1) @inspect P_A1 @stepover\n    P_B_given_A1 = ProbTable(\"B | A=1\", P_BA1.p / P_A1.p)  # Normalize to get conditional: P(B | A = 1) @inspect P_B_given_A1 @stepover\n\n    text(\"Forming the joint distribution can be exponentially slow...\")\n\n    text(\"**Probabilistic program**\")  # @clear P_BEA P_BEA1 P_BA1 P_A1 P_B_given_A1\n    text(\"A probabilistic program returns a sample from the joint distribution\")\n    text(\"...thereby defining it.\")\n    def alarm():\n        B = Bernoulli(0.05)  # @inspect B\n        E = Bernoulli(0.05)  # @inspect E\n        A = B or E  # @inspect A\n        return {\"B\": B, \"E\": E, \"A\": A}\n    sample = alarm()  # @inspect sample\n\n    text(\"**Rejection sampling**\")  # @clear sample\n    query = lambda sample: sample[\"B\"]\n    evidence = lambda sample: sample[\"A\"] == 1\n    result = rejection_sampling(alarm, query, evidence, num_samples=1)  # @inspect result\n    result = rejection_sampling(alarm, query, evidence, num_samples=300)  # @inspect result P_B_given_A1 @stepover\n\n    text(\"But rejection sampling can also be quite slow if the evidence is rare.\")\n    text(\"How can we perform probabilistic inference faster?\")\n\n\ndef rejection_sampling(program: Callable, query: Callable, evidence: Callable, num_samples: int) -> float:\n    \"\"\"Perform rejection sampling given:\n    - program: defines the Bayesian network, returns a sample\n    - query: sample -> value of interest\n    - evidence: sample -> whether to keep the sample\n    - num_samples: number of samples to draw\n    \"\"\"\n    counts = defaultdict(int)  # Record how many of each query value we got  @inspect counts\n\n    for _ in range(num_samples):\n        sample = program()  # @inspect sample @stepover\n        if evidence(sample):  # @stepover\n            counts[query(sample)] += 1  # @stepover @inspect counts\n    \n    # Normalize counts to obtain probabilities\n    total_count = sum(counts.values())  # @inspect total_count\n    probs = {q: counts[q] / total_count for q in counts}  # @inspect probs\n\n    return probs\n\n\ndef introduce_gibbs_sampling():\n    text(\"**Rejection sampling**\")\n    text(\"sample ~~sample~~ sample ~~sample~~ ~~sample~~ sample\")\n    text(\"- Pro: each sample is independent\")\n    text(\"- Con: we have to start from scratch for every sample\")\n    text(\"- Con: not using evidence while generating sample, leading to rejection\")\n    \n    text(\"**Gibbs sampling**: start with the previous sample (which always satisfies the evidence)\")\n    text(\"Basic idea:\")\n    text(\"- Start with an arbitrary sample\")\n    text(\"- Iteratively change one variable at a time conditioned on the other variables\")\n\n    text(\"Gibbs sampling is a special case of Markov chain Monte Carlo (MCMC)\")\n    text(\"sample \u2192 sample \u2192 sample \u2192 sample\")\n    text(\"- Pro: Start with samples that satisfy the evidence, so don't have to reject anything\")\n    text(\"- Con: samples are not independent, so require more samples\")\n\n    gibbs_telephone()              # Gibbs sampling on a telephone example\n    markov_blanket()               # Introduce the Markov blanket to speed things up\n    gibbs_alarm()                  # Gibbs sampling on the alarm Bayesian network\n    compare_gibbs_and_rejection()  # When does it work versus rejection sampling?\n\n    text(\"Further reading:\")\n    text(\"- Gibbs sampling is an example of a Markov chain Monte Carlo (MCMC) algorithm.\")\n    text(\"- A more general MCMC algorithm is Metropolis-Hastings (uses a proposal distribution).\")\n    text(\"- Theory: use mixing times to study effective running time (how correlated samples are)?\")\n    text(\"- Practice: simple and effective, but can be slow\")\n    \n\ndef gibbs_telephone():\n    text(\"**Example**: telephone\")\n    text(\"Bayesian network: A \u2192 B \u2192 C\")\n    text(\"Intuition: A sends a bit to B, B sends a bit to C, where at each step message might be corrupted\")\n\n    text(\"Here's the definition of the Bayesian network:\")\n    p_a = ProbTable(\"A\", [0.5, 0.5]) # p(a) @inspect p_a @stepover\n    p_b_given_a = ProbTable(\"B | A\", lambda a, b: 0.8 if b == a else 0.2, shape=(2, 2)) # p(b | a) @inspect p_b_given_a @stepover\n    p_c_given_b = ProbTable(\"C | B\", lambda b, c: 0.8 if c == b else 0.2, shape=(2, 2)) # p(c | b) @inspect p_c_given_b @stepover\n\n    text(\"Probabilistic inference goal: P(A | C = 1)\")\n    text(\"Intuition: C=1 encourages A=1, but weakly through two steps of corruption\")\n\n    text(\"Let's first run rejection sampling:\")  # @clear p_a p_b_given_a p_c_given_b\n    set_random_seed(3)\n    def telephone():\n        A = Bernoulli(0.5)  # @inspect A\n        B = Bernoulli(0.8 if A == 1 else 0.2)  # @inspect B\n        C = Bernoulli(0.8 if B == 1 else 0.2)  # @inspect C\n        return {\"A\": A, \"B\": B, \"C\": C}\n\n    sample = telephone()  # @inspect sample\n\n    query = lambda sample: sample[\"A\"]\n    evidence = lambda sample: sample[\"C\"] == 1\n    rejection_probs = rejection_sampling(telephone, query, evidence, num_samples=100)  # @inspect rejection_probs @stepover\n\n    set_random_seed(3)\n    text(\"Let's now run Gibbs sampling:\")  # @clear sample rejection_probs\n    text(\"Start with an initialization (full assignment)\")\n    text(\"For each variable X_i, change it based on all other variables\")\n    text(\"- Compute the conditional distribution of X_i given all other variables\")\n    text(\"- Sample X_i from this conditional distribution\")\n    \n    text(\"Initialize with an arbitrary sample that satisfies the evidence (D = 1):\")\n    x = {\"A\": 1, \"B\": 0, \"C\": 1}  # @inspect x\n\n    text(\"**Conditional distribution**\")\n    text(\"Suppose the goal is to sample B given A = a and C = c.\")\n\n    text(\"Express conditional probability in terms of joint probability:\")\n    text(\"P(B = b | A = a, C = c) = P(A = a, B = b, C = c) / P(A = a, C = c)\")\n\n    text(\"...with a normalizer which is probability of all other variables we're not sampling\")\n    text(\"P(A = a, C = c) = \u03a3_b P(A = a, B = b, C = c)\")\n\n    text(\"The joint probability is the product of the local conditional probabilities:\")\n    text(\"P(A = a, B = b, C = c) = p(a) p(b | a) p(c | b)\")\n    text(\"Note: we don't have to instantiate the entire joint distribution (could be exponentially large).\")\n\n    def joint_prob(x, var, value):  # @inspect x var value\n        # x is an assignment (e.g., {A: 0, B: 0, C: 1})#\n        # var: value is a change to the assignment (e.g., \"B\": 1)\n        # Let y be the updated assignment (e.g., {A: 0, B: 1, C: 1})\n        y = x | {var: value}  # @inspect y\n        # Compute joint probability with updated assignment: P(y)\n        return p_a.p[y[\"A\"]] * p_b_given_a.p[y[\"A\"], y[\"B\"]] * p_c_given_b.p[y[\"B\"], y[\"C\"]]\n\n    text(\"Note we don't instantiate the joint distribution here.\")\n    text(\"But we do have to touch every variable (we'll come back to this later).\")\n\n    text(\"Let's say we were sampling B \u2208 {0, 1}:\")\n    p_ab0c = joint_prob(x, \"B\", 0)  # P(A = 1, B = 0, C = 1) @inspect p_ab0c\n    p_ab1c = joint_prob(x, \"B\", 1)  # P(A = 1, B = 1, C = 1) @inspect p_ab1c\n    p_ac = p_ab0c + p_ab1c  # P(A = 1, C = 1) @inspect p_ac\n    p_b0_given_ac = p_ab0c / p_ac  # P(B = 0 | A = 1, C = 1) @inspect p_b0_given_ac\n    p_b1_given_ac = p_ab1c / p_ac  # P(B = 1 | A = 1, C = 1) @inspect p_b1_given_ac\n    x[\"B\"] = sample_dict({0: p_b0_given_ac, 1: p_b1_given_ac})  # @inspect x\n    text(\"Note that B gets pulled to 1 because of A=1 and C=1.\")\n\n    text(\"Let's define Gibbs sampling in greater generality:\")  # @clear p_ab0c p_ab1c p_ac p_b0_given_ac p_b1_given_ac x\n    gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs\n\n    text(\"Run Gibbs sampling for multiple iterations:\")\n    gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=100)  # @inspect gibbs_probs @stepover\n\n    text(\"Comparing with rejection sampling, both are in the ballpark.\") # @inspect rejection_probs\n\n    text(\"Running time: O(#iterations * #variables * |domain| * #variables)\")\n\n    text(\"Summary:\")\n    text(\"- Update one variable at a time using its conditional distribution given all other variables\")\n    text(\"- Compute the conditional distribution using the joint distribution\")\n    text(\"- Only have to sum over domain of the variable we're sampling\")\n\n    text(\"Can we be even more efficient and not touch variables we're not sampling?\")\n\n\ndef markov_blanket():\n    text(\"Joint probability: p(a) p(b | a) p(c | b) p(d | c) p(e | d)\")\n    text(\"Can we avoid having to compute the full joint probability every time we sample a variable?\")\n    text(\"Intuitively, only one variable changes...\")\n\n    text(\"Recall the telephone Bayesian network: A \u2192 B \u2192 C\")\n    p_a = ProbTable(\"A\", [0.5, 0.5]) # p(a) @inspect p_a @stepover\n    p_b_given_a = ProbTable(\"B | A\", lambda a, b: 0.8 if b == a else 0.2, shape=(2, 2))  # p(b | a) @inspect p_b_given_a @stepover\n    p_c_given_b = ProbTable(\"C | B\", lambda b, c: 0.8 if c == b else 0.2, shape=(2, 2))  # p(c | b) @inspect p_c_given_b @stepover\n\n    text(\"Suppose we're sampling P(A | B = b, C = c)\")\n    text(\"Let's look at the joint distribution:\")\n    text(\"P(A = 0, B = b, C = c) = p(a = 0) p(b | a = 0) p(c | b)\")\n    text(\"P(A = 1, B = b, C = c) = p(a = 1) p(b | a = 1) p(c | b)\")\n    text(\"P(B = b, C = c) = \u03a3_a p(a) p(b | a) p(c | b)\")\n    text(\"Notice that p(c | b) shows up in both cases, and does not impact P(A | B = b, C = c).\")\n    text(\"So we can just ignore it!\")\n\n    text(\"In general, we need to only include variables that touch the variable we're sampling.\")\n    text(\"This set of variables is called the **Markov blanket**.\")\n    text(\"The Markov blanket of a variable is all its children and parents.\")\n    text(\"MarkovBlanket(A) = {B}\")\n    text(\"MarkovBlanket(B) = {A, C}\")\n    text(\"MarkovBlanket(C) = {B}\")\n\n    text(\"Instead of computing the joint probability\")\n    text(\"...let us just include the variables in the Markov blanket.\")\n    def markov_prob(x, var, value):\n        y = x | {var: value}\n        if var == \"A\":\n            return p_a.p[y[\"A\"]] * p_b_given_a.p[y[\"B\"], y[\"A\"]]  # no p(c | b)\n        elif var == \"B\":\n            return p_b_given_a.p[y[\"B\"], y[\"A\"]] * p_c_given_b.p[y[\"C\"], y[\"B\"]]  # no p(a)\n        else:\n            raise ValueError(f\"Unknown variable: {var}\")\n\n    text(\"Now we can run Gibbs sampling with the Markov blanket:\")\n    x = {\"A\": 0, \"B\": 0, \"C\": 1}\n    query = lambda sample: sample[\"A\"]\n    probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=markov_prob, num_iterations=100)  # @inspect probs @stepover\n\n    text(\"Running time with joint_prob: O(#iterations * #variables * |domain| * #variables)\")\n    text(\"Running time with markov_prob: O(#iterations * #variables * |domain| * **|markov_blanket|**)\")\n\n    text(\"Summary:\")\n    text(\"- Markov blanket of a node: all its children and parents\")\n    text(\"- Gibbs sampling requires local conditional probabilities of node and its Markov blanket\")\n    text(\"- Much more efficient if Markov blankets are small\")\n\n\ndef gibbs_alarm():\n    text(\"Let's now run Gibbs sampling on the alarm Bayesian network.\")\n\n    image(\"images/alarm-bayes.png\", width=200)\n    p_b = ProbTable(\"B\", [0.95, 0.05]) # p(b) @inspect p_b @stepover\n    p_e = ProbTable(\"E\", [0.95, 0.05]) # p(e) @inspect p_e @stepover\n    p_a_given_be = ProbTable(\"A | B E\", lambda b, e, a: a == (b or e), shape=(2, 2, 2)) # p(a | b, e) @inspect p_a_given_be @stepover\n\n    # Initialize with an arbitrary sample that satisfies the evidence\n    x = {\"B\": 1, \"E\": 1, \"A\": 1}  # @inspect x\n    \n    # Iterate over each variable (that's not evidence)\n    def compute_prob(x, var, value):\n        y = x | {var: value}\n        return p_b.p[y[\"B\"]] * p_e.p[y[\"E\"]] * p_a_given_be.p[y[\"B\"], y[\"E\"], y[\"A\"]]\n\n    # We're interesting in P(B | ...)\n    query = lambda sample: sample[\"B\"]\n\n    # Run Gibbs sampling\n    probs = gibbs_sampling(x, vars=[\"B\", \"E\"], query=query, joint_prob=compute_prob, num_iterations=100)  # @inspect probs @stepover\n    probs = gibbs_sampling(x, vars=[\"B\", \"E\"], query=query, joint_prob=compute_prob, num_iterations=200)  # @inspect probs @stepover\n\n    text(\"Note that the estimates aren't quite accurate...\")\n\n\ndef compare_gibbs_and_rejection():\n    text(\"What examples are hard for rejection sampling?\")\n    text(\"Answer: when evidence has low probability.\")\n    text(\"A \u2192 B\")\n    p_a = ProbTable(\"A\", [0.5, 0.5]) # p(a) @inspect p_a @stepover\n    p_b_given_a = ProbTable(\"B | A\", [[0.9999, 0.0001], [0.9998, 0.0002]])  # p(b | a) @inspect p_b_given_a @stepover\n    text(\"Compute P(A | B = 1)\")\n    text(\"Reason: need to reject all samples that don't match the evidence.\")\n    text(\"Gibbs sample conditions on B = 1, so will work fine.\")\n\n    text(\"What examples are hard for Gibbs sampling?\")  # @clear p_a p_b_given_a\n    text(\"Answer: when variables are highly correlated.\")\n    text(\"A \u2192 B\")\n    p_a = ProbTable(\"A\", [0.5, 0.5]) # p(a) @inspect p_a @stepover\n    p_b_given_a = ProbTable(\"B | A\", lambda a, b: a == b, shape=(2, 2))  # p(b | a) @inspect p_b_given_a @stepover\n    text(\"Probabilistic inference: P(A) [no evidence]\")\n    x = {\"A\": 0, \"B\": 0}\n    text(\"Rejection sampling generates from scratch every time, so works perfectly (no rejection).\")\n    text(\"Gibbs sampling gets stuck and will not explore A = 1.\")\n    query = lambda sample: sample[\"A\"]\n    def joint_prob(x, var, value):\n        y = x | {var: value}\n        return p_a.p[y[\"A\"]] * p_b_given_a.p[y[\"A\"], y[\"B\"]]\n    gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=50)  # @inspect gibbs_probs @stepover\n\n    text(\"Summary:\")\n    text(\"- Rare events are hard for rejection sampling\")\n    text(\"- Highly correlated variables are hard for Gibbs sampling\")\n\n\ndef gibbs_sampling(init_x: dict, vars: list[str], query: Callable, joint_prob: Callable, num_iterations: int) -> dict:\n    \"\"\"\n    Run Gibbs sampling from the initial assignment `init_x`.\n    Cycle `num_iterations` over `vars` (excludes evidence variables).\n    Return the estimated distribution over query.\n    \"\"\"\n    # Initialize the assignment\n    x = dict(init_x)  # Make a copy (good hygiene) @inspect x\n\n    # Track counts of query values\n    counts = defaultdict(int)\n\n    # Keep iterating over all the variables\n    for _ in range(num_iterations):\n        for var in vars:  # @inspect var\n            # Compute probabilities for each assignment of {var: value}\n            probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover\n\n            # Normalize probabilities\n            probs = normalize_dict(probs)  # @inspect probs\n\n            # Sample the variable\n            x[var] = sample_dict(probs)  # @inspect x\n\n            # Record the query value\n            counts[query(x)] += 1  # @inspect counts\n\n    # Normalize to get the estimated distribution over query\n    probs = normalize_dict(counts)  # @inspect probs\n\n    return probs\n\n\ndef introduce_conditional_independence():\n    text(\"So far: can do probabilistic inference on Bayesian networks\")\n    text(\"They have been fairly agnostic to the structure of the Bayesian network.\")\n    text(\"Now: let's explore some properties of the Bayesian network.\")\n    text(\"We will connect graph properties to probabilistic properties (in particularly independence).\")\n\n    text(\"**Independence**\")\n    text(\"Two variables A and B are independent iff:\")\n    text(\"P(A = a, B = b) = P(A = a) P(B = b) for all a, b\")\n\n    text(\"Example 1 (A B):\")\n    text(\"P(A = a, B = b) = p(a) p(b)\")\n    text(\"A and B are independent\")\n\n    text(\"Example 2 (A \u2192 B):\")\n    text(\"P(A = a, B = b) = p(a) p(b | a)\")\n    text(\"A and B are not independent\")\n\n    text(\"Example 3 (A, B \u2192 C):\")\n    text(\"P(A = a, B = b, C = c) = p(a) p(b | a) p(c | b, a)\")\n    text(\"P(A = a, B = b) = \u03a3_c P(A = a, B = b, C = c) = \u03a3_c p(a) p(b) p(c | b, a) = p(a) p(b)\")\n    text(\"A and B are independent (even if they are connected)!\")\n\n    text(\"Example 4 (C \u2192 A, B):\")\n    text(\"P(A = a, B = b, C = c) = p(c) p(a | c) p(b | c)\")\n    text(\"P(A = a, B = b) = \u03a3_c P(A = a, B = b, C = c) = \u03a3_c p(c) p(a | c) p(b | c)\")\n    text(\"A and B are not independent!\")\n\n    text(\"**Conditional independence**\")\n    text(\"Two variables A and B are conditionally independent given C = c iff:\")\n    text(\"P(A = a, B = b | C = c) = P(A = a | C = c) P(B = b | C = c) for all a, b\")\n    \n    text(\"Example 4 again (C \u2192 A, B):\")\n    text(\"P(A = a, B = b | C = c) = p(c) p(a | c) p(b | c) / p(c) = p(a | c) p(b | c)\")\n    text(\"A and B are conditionally independent given C = c\")\n\n    text(\"Example 3 again (A, B \u2192 C):\")\n    text(\"P(A = a, B = b | C = c) = p(a) p(b) p(c | a, b)\")\n    text(\"A and B are not conditionally independent given C = c\")\n\n    text(\"**Alarm example**\")\n    text(\"Variables: Burglary B, Earthquake E, Alarm A\")\n    image(\"images/alarm-bayes.png\", width=200)\n    text(\"B and E are independent\")\n    text(\"B and E are not conditionally independent given A = 1\")\n\n    text(\"**General algorithm**\")\n    text(\"Question: are A and B independent given C?\")\n    text(\"1. Shade in the variables C\")\n    text(\"2. Recursively remove any non-shaded leaves\")\n    text(\"3. Connect parents to each other (marriage)\")\n    text(\"3. Return whether there is a path from A to B that doesn't go through any shaded nodes\")\n    \n    text(\"**Medical diagnosis example**\")\n    text(\"Variables: Cold C, Allergies A, Cough H, Itchy eyes I\")\n    image(\"images/medical-bayes.png\", width=200)\n    text(\"C and A are independent\")\n    text(\"C and I are independent\")\n    text(\"C and H are independent given A\")\n    text(\"C and I are independent given A\")\n    text(\"C and I are independent given H, A\")\n    \n\nif __name__ == \"__main__\":\n    main()"
  },
  "hidden_line_numbers": {
    "gibbs_sampling.py": []
  },
  "steps": [
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 9,
          "function_name": "main",
          "code": "def main():"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 10,
          "function_name": "main",
          "code": "text(\"### Lecture 13: Gibbs sampling\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "### Lecture 13: Gibbs sampling",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 12,
          "function_name": "main",
          "code": "text(\"Last time: Bayesian networks, rejection sampling\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Last time: Bayesian networks, rejection sampling",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 13,
          "function_name": "main",
          "code": "text(\"This time: faster probabilistic inference methods (Gibbs sampling) + conditional independence\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "This time: faster probabilistic inference methods (Gibbs sampling) + conditional independence",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 27,
          "function_name": "review_bayesian_networks",
          "code": "def review_bayesian_networks():"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 28,
          "function_name": "review_bayesian_networks",
          "code": "text(\"**Joint distribution**: like a database that specifies how the world works\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "**Joint distribution**: like a database that specifies how the world works",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 29,
          "function_name": "review_bayesian_networks",
          "code": "text(\"1. Define a set of random variables: X = (X_1, ..., X_n)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "1. Define a set of random variables: X = (X_1, ..., X_n)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 30,
          "function_name": "review_bayesian_networks",
          "code": "text(\"Example: B(urglary), E(arthquake), A(larm)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Example: B(urglary), E(arthquake), A(larm)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 32,
          "function_name": "review_bayesian_networks",
          "code": "text(\"2. Define a directed acyclic graph (DAG) over the variables\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "2. Define a directed acyclic graph (DAG) over the variables",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 33,
          "function_name": "review_bayesian_networks",
          "code": "text(\"Example: B \u2192 A, E \u2192 A\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Example: B \u2192 A, E \u2192 A",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 34,
          "function_name": "review_bayesian_networks",
          "code": "image(\"images/alarm-bayes.png\", width=200)"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "image",
          "data": "images/alarm-bayes.png",
          "style": {
            "width": 200
          },
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 36,
          "function_name": "review_bayesian_networks",
          "code": "text(\"3. For each node, define a local conditional distribution: p(x_i | parents(x_i)).\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "3. For each node, define a local conditional distribution: p(x_i | parents(x_i)).",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 37,
          "function_name": "review_bayesian_networks",
          "code": "text(\"Example: p(b), p(e), p(a | b, e)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Example: p(b), p(e), p(a | b, e)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 38,
          "function_name": "review_bayesian_networks",
          "code": "p_b = ProbTable(\"B\", [0.95, 0.05]) # p(b) @inspect p_b @stepover"
        }
      ],
      "env": {
        "p_b": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "b",
              "P(B=b)"
            ],
            [
              "0",
              "0.95"
            ],
            [
              "1",
              "0.05"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            3,
            2
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 39,
          "function_name": "review_bayesian_networks",
          "code": "p_e = ProbTable(\"E\", [0.95, 0.05]) # p(e) @inspect p_e @stepover"
        }
      ],
      "env": {
        "p_e": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "e",
              "P(E=e)"
            ],
            [
              "0",
              "0.95"
            ],
            [
              "1",
              "0.05"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            3,
            2
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 40,
          "function_name": "review_bayesian_networks",
          "code": "p_a_given_be = ProbTable(\"A | B E\", lambda b, e, a: a == (b or e), shape=(2, 2, 2)) # p(a | b, e) @inspect p_a_given_be @stepover"
        }
      ],
      "env": {
        "p_a_given_be": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "b",
              "e",
              "a",
              "P(A=a | B=b, E=e)"
            ],
            [
              "0",
              "0",
              "0",
              "1.0"
            ],
            [
              "0",
              "0",
              "1",
              "0.0"
            ],
            [
              "0",
              "1",
              "0",
              "0.0"
            ],
            [
              "0",
              "1",
              "1",
              "1.0"
            ],
            [
              "1",
              "0",
              "0",
              "0.0"
            ],
            [
              "1",
              "0",
              "1",
              "1.0"
            ],
            [
              "1",
              "1",
              "0",
              "0.0"
            ],
            [
              "1",
              "1",
              "1",
              "1.0"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            9,
            4
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 42,
          "function_name": "review_bayesian_networks",
          "code": "text(\"4. Define the joint distribution: P(X_1, ..., X_n) = \u03a0_i p(x_i | parents(x_i))\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "4. Define the joint distribution: P(X_1, ..., X_n) = \u03a0_i p(x_i | parents(x_i))",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 43,
          "function_name": "review_bayesian_networks",
          "code": "text(\"Example: P(B, E, A) = p(b) p(e) p(a | b, e)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Example: P(B, E, A) = p(b) p(e) p(a | b, e)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 44,
          "function_name": "review_bayesian_networks",
          "code": "P_BEA = ProbTable(\"B E A\", einsum(p_b.p, p_e.p, p_a_given_be.p, \"b, e, b e a -> b e a\"))  # P(B, E, A) @inspect P_BEA @stepover"
        }
      ],
      "env": {
        "P_BEA": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "b",
              "e",
              "a",
              "P(B=b, E=e, A=a)"
            ],
            [
              "0",
              "0",
              "0",
              "0.9025"
            ],
            [
              "0",
              "0",
              "1",
              "0.0"
            ],
            [
              "0",
              "1",
              "0",
              "0.0"
            ],
            [
              "0",
              "1",
              "1",
              "0.0475"
            ],
            [
              "1",
              "0",
              "0",
              "0.0"
            ],
            [
              "1",
              "0",
              "1",
              "0.0475"
            ],
            [
              "1",
              "1",
              "0",
              "0.0"
            ],
            [
              "1",
              "1",
              "1",
              "0.0025000000000000005"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            9,
            4
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 46,
          "function_name": "review_bayesian_networks",
          "code": "text(\"**Probabilistic inference**: answer questions (like SQL) on the joint distribution\")  # @clear p_b p_e p_a_given_be"
        }
      ],
      "env": {
        "p_b": null,
        "p_e": null,
        "p_a_given_be": null
      },
      "renderings": [
        {
          "type": "markdown",
          "data": "**Probabilistic inference**: answer questions (like SQL) on the joint distribution",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 47,
          "function_name": "review_bayesian_networks",
          "code": "text(\"Example: P(B | A = 1)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Example: P(B | A = 1)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 48,
          "function_name": "review_bayesian_networks",
          "code": "P_BEA1 = ProbTable(\"B E A=1\", P_BEA.p[:, :, 1])  # Condition on evidence: P(B, E, A = 1) @inspect P_BEA1 @stepover"
        }
      ],
      "env": {
        "P_BEA1": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "b",
              "e",
              "P(B=b, E=e, A=1)"
            ],
            [
              "0",
              "0",
              "0.0"
            ],
            [
              "0",
              "1",
              "0.0475"
            ],
            [
              "1",
              "0",
              "0.0475"
            ],
            [
              "1",
              "1",
              "0.0025000000000000005"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            5,
            3
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 49,
          "function_name": "review_bayesian_networks",
          "code": "P_BA1 = ProbTable(\"B A=1\", einsum(P_BEA1.p, \"b e -> b\"))  # Marginalize out other variables: P(B, A = 1) @inspect P_BA1 @stepover"
        }
      ],
      "env": {
        "P_BA1": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "b",
              "P(B=b, A=1)"
            ],
            [
              "0",
              "0.0475"
            ],
            [
              "1",
              "0.05"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            3,
            2
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 50,
          "function_name": "review_bayesian_networks",
          "code": "P_A1 = ProbTable(\"A=1\", einsum(P_BA1.p, \"b ->\"))  # Probability of evidence: P(A = 1) @inspect P_A1 @stepover"
        }
      ],
      "env": {
        "P_A1": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "P(A=1)"
            ],
            [
              "0.0975"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            2,
            1
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 51,
          "function_name": "review_bayesian_networks",
          "code": "P_B_given_A1 = ProbTable(\"B | A=1\", P_BA1.p / P_A1.p)  # Normalize to get conditional: P(B | A = 1) @inspect P_B_given_A1 @stepover"
        }
      ],
      "env": {
        "P_B_given_A1": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "b",
              "P(B=b | A=1)"
            ],
            [
              "0",
              "0.48717948717948717"
            ],
            [
              "1",
              "0.5128205128205129"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            3,
            2
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 53,
          "function_name": "review_bayesian_networks",
          "code": "text(\"Forming the joint distribution can be exponentially slow...\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Forming the joint distribution can be exponentially slow...",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 55,
          "function_name": "review_bayesian_networks",
          "code": "text(\"**Probabilistic program**\")  # @clear P_BEA P_BEA1 P_BA1 P_A1 P_B_given_A1"
        }
      ],
      "env": {
        "P_BEA": null,
        "P_BEA1": null,
        "P_BA1": null,
        "P_A1": null,
        "P_B_given_A1": null
      },
      "renderings": [
        {
          "type": "markdown",
          "data": "**Probabilistic program**",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 56,
          "function_name": "review_bayesian_networks",
          "code": "text(\"A probabilistic program returns a sample from the joint distribution\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "A probabilistic program returns a sample from the joint distribution",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 57,
          "function_name": "review_bayesian_networks",
          "code": "text(\"...thereby defining it.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "...thereby defining it.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 58,
          "function_name": "review_bayesian_networks",
          "code": "def alarm():"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 63,
          "function_name": "review_bayesian_networks",
          "code": "sample = alarm()  # @inspect sample"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 63,
          "function_name": "review_bayesian_networks",
          "code": "sample = alarm()  # @inspect sample"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 58,
          "function_name": "alarm",
          "code": "def alarm():"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 63,
          "function_name": "review_bayesian_networks",
          "code": "sample = alarm()  # @inspect sample"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 59,
          "function_name": "alarm",
          "code": "B = Bernoulli(0.05)  # @inspect B"
        }
      ],
      "env": {
        "B": {
          "type": "numpy.int64",
          "contents": 0,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 63,
          "function_name": "review_bayesian_networks",
          "code": "sample = alarm()  # @inspect sample"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 60,
          "function_name": "alarm",
          "code": "E = Bernoulli(0.05)  # @inspect E"
        }
      ],
      "env": {
        "E": {
          "type": "numpy.int64",
          "contents": 0,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 63,
          "function_name": "review_bayesian_networks",
          "code": "sample = alarm()  # @inspect sample"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 61,
          "function_name": "alarm",
          "code": "A = B or E  # @inspect A"
        }
      ],
      "env": {
        "A": {
          "type": "numpy.int64",
          "contents": 0,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 63,
          "function_name": "review_bayesian_networks",
          "code": "sample = alarm()  # @inspect sample"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 62,
          "function_name": "alarm",
          "code": "return {\"B\": B, \"E\": E, \"A\": A}"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 63,
          "function_name": "review_bayesian_networks",
          "code": "sample = alarm()  # @inspect sample"
        }
      ],
      "env": {
        "sample": {
          "type": "dict",
          "contents": {
            "B": {
              "type": "numpy.int64",
              "contents": 0,
              "dtype": null,
              "shape": null
            },
            "E": {
              "type": "numpy.int64",
              "contents": 0,
              "dtype": null,
              "shape": null
            },
            "A": {
              "type": "numpy.int64",
              "contents": 0,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 65,
          "function_name": "review_bayesian_networks",
          "code": "text(\"**Rejection sampling**\")  # @clear sample"
        }
      ],
      "env": {
        "sample": null
      },
      "renderings": [
        {
          "type": "markdown",
          "data": "**Rejection sampling**",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 66,
          "function_name": "review_bayesian_networks",
          "code": "query = lambda sample: sample[\"B\"]"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 67,
          "function_name": "review_bayesian_networks",
          "code": "evidence = lambda sample: sample[\"A\"] == 1"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 68,
          "function_name": "review_bayesian_networks",
          "code": "result = rejection_sampling(alarm, query, evidence, num_samples=1)  # @inspect result"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 68,
          "function_name": "review_bayesian_networks",
          "code": "result = rejection_sampling(alarm, query, evidence, num_samples=1)  # @inspect result"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 75,
          "function_name": "rejection_sampling",
          "code": "def rejection_sampling(program: Callable, query: Callable, evidence: Callable, num_samples: int) -> float:"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 68,
          "function_name": "review_bayesian_networks",
          "code": "result = rejection_sampling(alarm, query, evidence, num_samples=1)  # @inspect result"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 82,
          "function_name": "rejection_sampling",
          "code": "counts = defaultdict(int)  # Record how many of each query value we got  @inspect counts"
        }
      ],
      "env": {
        "counts": {
          "type": "collections.defaultdict",
          "contents": {},
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 68,
          "function_name": "review_bayesian_networks",
          "code": "result = rejection_sampling(alarm, query, evidence, num_samples=1)  # @inspect result"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 84,
          "function_name": "rejection_sampling",
          "code": "for _ in range(num_samples):"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 68,
          "function_name": "review_bayesian_networks",
          "code": "result = rejection_sampling(alarm, query, evidence, num_samples=1)  # @inspect result"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 85,
          "function_name": "rejection_sampling",
          "code": "sample = program()  # @inspect sample @stepover"
        }
      ],
      "env": {
        "sample": {
          "type": "dict",
          "contents": {
            "B": {
              "type": "numpy.int64",
              "contents": 0,
              "dtype": null,
              "shape": null
            },
            "E": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "A": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 68,
          "function_name": "review_bayesian_networks",
          "code": "result = rejection_sampling(alarm, query, evidence, num_samples=1)  # @inspect result"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 86,
          "function_name": "rejection_sampling",
          "code": "if evidence(sample):  # @stepover"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 68,
          "function_name": "review_bayesian_networks",
          "code": "result = rejection_sampling(alarm, query, evidence, num_samples=1)  # @inspect result"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 87,
          "function_name": "rejection_sampling",
          "code": "counts[query(sample)] += 1  # @stepover @inspect counts"
        }
      ],
      "env": {
        "counts": {
          "type": "collections.defaultdict",
          "contents": {
            "0": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 68,
          "function_name": "review_bayesian_networks",
          "code": "result = rejection_sampling(alarm, query, evidence, num_samples=1)  # @inspect result"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 84,
          "function_name": "rejection_sampling",
          "code": "for _ in range(num_samples):"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 68,
          "function_name": "review_bayesian_networks",
          "code": "result = rejection_sampling(alarm, query, evidence, num_samples=1)  # @inspect result"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 90,
          "function_name": "rejection_sampling",
          "code": "total_count = sum(counts.values())  # @inspect total_count"
        }
      ],
      "env": {
        "total_count": {
          "type": "int",
          "contents": 1,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 68,
          "function_name": "review_bayesian_networks",
          "code": "result = rejection_sampling(alarm, query, evidence, num_samples=1)  # @inspect result"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 91,
          "function_name": "rejection_sampling",
          "code": "probs = {q: counts[q] / total_count for q in counts}  # @inspect probs"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 68,
          "function_name": "review_bayesian_networks",
          "code": "result = rejection_sampling(alarm, query, evidence, num_samples=1)  # @inspect result"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 91,
          "function_name": "rejection_sampling",
          "code": "probs = {q: counts[q] / total_count for q in counts}  # @inspect probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 91,
          "function_name": "<dictcomp>",
          "code": "probs = {q: counts[q] / total_count for q in counts}  # @inspect probs"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 68,
          "function_name": "review_bayesian_networks",
          "code": "result = rejection_sampling(alarm, query, evidence, num_samples=1)  # @inspect result"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 91,
          "function_name": "rejection_sampling",
          "code": "probs = {q: counts[q] / total_count for q in counts}  # @inspect probs"
        }
      ],
      "env": {
        "probs": {
          "type": "dict",
          "contents": {
            "0": {
              "type": "float",
              "contents": 1.0,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 68,
          "function_name": "review_bayesian_networks",
          "code": "result = rejection_sampling(alarm, query, evidence, num_samples=1)  # @inspect result"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 93,
          "function_name": "rejection_sampling",
          "code": "return probs"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 68,
          "function_name": "review_bayesian_networks",
          "code": "result = rejection_sampling(alarm, query, evidence, num_samples=1)  # @inspect result"
        }
      ],
      "env": {
        "result": {
          "type": "dict",
          "contents": {
            "0": {
              "type": "float",
              "contents": 1.0,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 69,
          "function_name": "review_bayesian_networks",
          "code": "result = rejection_sampling(alarm, query, evidence, num_samples=300)  # @inspect result P_B_given_A1 @stepover"
        }
      ],
      "env": {
        "result": {
          "type": "dict",
          "contents": {
            "0": {
              "type": "float",
              "contents": 0.5517241379310345,
              "dtype": null,
              "shape": null
            },
            "1": {
              "type": "float",
              "contents": 0.4482758620689655,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        },
        "P_B_given_A1": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "b",
              "P(B=b | A=1)"
            ],
            [
              "0",
              "0.48717948717948717"
            ],
            [
              "1",
              "0.5128205128205129"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            3,
            2
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 71,
          "function_name": "review_bayesian_networks",
          "code": "text(\"But rejection sampling can also be quite slow if the evidence is rare.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "But rejection sampling can also be quite slow if the evidence is rare.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 72,
          "function_name": "review_bayesian_networks",
          "code": "text(\"How can we perform probabilistic inference faster?\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "How can we perform probabilistic inference faster?",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 15,
          "function_name": "main",
          "code": "review_bayesian_networks()"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 96,
          "function_name": "introduce_gibbs_sampling",
          "code": "def introduce_gibbs_sampling():"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 97,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"**Rejection sampling**\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "**Rejection sampling**",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 98,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"sample ~~sample~~ sample ~~sample~~ ~~sample~~ sample\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "sample ~~sample~~ sample ~~sample~~ ~~sample~~ sample",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 99,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"- Pro: each sample is independent\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Pro: each sample is independent",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 100,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"- Con: we have to start from scratch for every sample\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Con: we have to start from scratch for every sample",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 101,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"- Con: not using evidence while generating sample, leading to rejection\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Con: not using evidence while generating sample, leading to rejection",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 103,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"**Gibbs sampling**: start with the previous sample (which always satisfies the evidence)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "**Gibbs sampling**: start with the previous sample (which always satisfies the evidence)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 104,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"Basic idea:\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Basic idea:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 105,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"- Start with an arbitrary sample\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Start with an arbitrary sample",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 106,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"- Iteratively change one variable at a time conditioned on the other variables\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Iteratively change one variable at a time conditioned on the other variables",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 108,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"Gibbs sampling is a special case of Markov chain Monte Carlo (MCMC)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Gibbs sampling is a special case of Markov chain Monte Carlo (MCMC)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 109,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"sample \u2192 sample \u2192 sample \u2192 sample\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "sample \u2192 sample \u2192 sample \u2192 sample",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 110,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"- Pro: Start with samples that satisfy the evidence, so don't have to reject anything\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Pro: Start with samples that satisfy the evidence, so don't have to reject anything",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 111,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"- Con: samples are not independent, so require more samples\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Con: samples are not independent, so require more samples",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 125,
          "function_name": "gibbs_telephone",
          "code": "def gibbs_telephone():"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 126,
          "function_name": "gibbs_telephone",
          "code": "text(\"**Example**: telephone\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "**Example**: telephone",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 127,
          "function_name": "gibbs_telephone",
          "code": "text(\"Bayesian network: A \u2192 B \u2192 C\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Bayesian network: A \u2192 B \u2192 C",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 128,
          "function_name": "gibbs_telephone",
          "code": "text(\"Intuition: A sends a bit to B, B sends a bit to C, where at each step message might be corrupted\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Intuition: A sends a bit to B, B sends a bit to C, where at each step message might be corrupted",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 130,
          "function_name": "gibbs_telephone",
          "code": "text(\"Here's the definition of the Bayesian network:\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Here's the definition of the Bayesian network:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 131,
          "function_name": "gibbs_telephone",
          "code": "p_a = ProbTable(\"A\", [0.5, 0.5]) # p(a) @inspect p_a @stepover"
        }
      ],
      "env": {
        "p_a": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "a",
              "P(A=a)"
            ],
            [
              "0",
              "0.5"
            ],
            [
              "1",
              "0.5"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            3,
            2
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 132,
          "function_name": "gibbs_telephone",
          "code": "p_b_given_a = ProbTable(\"B | A\", lambda a, b: 0.8 if b == a else 0.2, shape=(2, 2)) # p(b | a) @inspect p_b_given_a @stepover"
        }
      ],
      "env": {
        "p_b_given_a": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "a",
              "b",
              "P(B=b | A=a)"
            ],
            [
              "0",
              "0",
              "0.8"
            ],
            [
              "0",
              "1",
              "0.2"
            ],
            [
              "1",
              "0",
              "0.2"
            ],
            [
              "1",
              "1",
              "0.8"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            5,
            3
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 133,
          "function_name": "gibbs_telephone",
          "code": "p_c_given_b = ProbTable(\"C | B\", lambda b, c: 0.8 if c == b else 0.2, shape=(2, 2)) # p(c | b) @inspect p_c_given_b @stepover"
        }
      ],
      "env": {
        "p_c_given_b": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "b",
              "c",
              "P(C=c | B=b)"
            ],
            [
              "0",
              "0",
              "0.8"
            ],
            [
              "0",
              "1",
              "0.2"
            ],
            [
              "1",
              "0",
              "0.2"
            ],
            [
              "1",
              "1",
              "0.8"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            5,
            3
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 135,
          "function_name": "gibbs_telephone",
          "code": "text(\"Probabilistic inference goal: P(A | C = 1)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Probabilistic inference goal: P(A | C = 1)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 136,
          "function_name": "gibbs_telephone",
          "code": "text(\"Intuition: C=1 encourages A=1, but weakly through two steps of corruption\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Intuition: C=1 encourages A=1, but weakly through two steps of corruption",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 138,
          "function_name": "gibbs_telephone",
          "code": "text(\"Let's first run rejection sampling:\")  # @clear p_a p_b_given_a p_c_given_b"
        }
      ],
      "env": {
        "p_a": null,
        "p_b_given_a": null,
        "p_c_given_b": null
      },
      "renderings": [
        {
          "type": "markdown",
          "data": "Let's first run rejection sampling:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 139,
          "function_name": "gibbs_telephone",
          "code": "set_random_seed(3)"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 140,
          "function_name": "gibbs_telephone",
          "code": "def telephone():"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 146,
          "function_name": "gibbs_telephone",
          "code": "sample = telephone()  # @inspect sample"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 146,
          "function_name": "gibbs_telephone",
          "code": "sample = telephone()  # @inspect sample"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 140,
          "function_name": "telephone",
          "code": "def telephone():"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 146,
          "function_name": "gibbs_telephone",
          "code": "sample = telephone()  # @inspect sample"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 141,
          "function_name": "telephone",
          "code": "A = Bernoulli(0.5)  # @inspect A"
        }
      ],
      "env": {
        "A": {
          "type": "numpy.int64",
          "contents": 1,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 146,
          "function_name": "gibbs_telephone",
          "code": "sample = telephone()  # @inspect sample"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 142,
          "function_name": "telephone",
          "code": "B = Bernoulli(0.8 if A == 1 else 0.2)  # @inspect B"
        }
      ],
      "env": {
        "B": {
          "type": "numpy.int64",
          "contents": 1,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 146,
          "function_name": "gibbs_telephone",
          "code": "sample = telephone()  # @inspect sample"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 143,
          "function_name": "telephone",
          "code": "C = Bernoulli(0.8 if B == 1 else 0.2)  # @inspect C"
        }
      ],
      "env": {
        "C": {
          "type": "numpy.int64",
          "contents": 1,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 146,
          "function_name": "gibbs_telephone",
          "code": "sample = telephone()  # @inspect sample"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 144,
          "function_name": "telephone",
          "code": "return {\"A\": A, \"B\": B, \"C\": C}"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 146,
          "function_name": "gibbs_telephone",
          "code": "sample = telephone()  # @inspect sample"
        }
      ],
      "env": {
        "sample": {
          "type": "dict",
          "contents": {
            "A": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "B": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "C": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 148,
          "function_name": "gibbs_telephone",
          "code": "query = lambda sample: sample[\"A\"]"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 149,
          "function_name": "gibbs_telephone",
          "code": "evidence = lambda sample: sample[\"C\"] == 1"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 150,
          "function_name": "gibbs_telephone",
          "code": "rejection_probs = rejection_sampling(telephone, query, evidence, num_samples=100)  # @inspect rejection_probs @stepover"
        }
      ],
      "env": {
        "rejection_probs": {
          "type": "dict",
          "contents": {
            "1": {
              "type": "float",
              "contents": 0.6530612244897959,
              "dtype": null,
              "shape": null
            },
            "0": {
              "type": "float",
              "contents": 0.3469387755102041,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 152,
          "function_name": "gibbs_telephone",
          "code": "set_random_seed(3)"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 153,
          "function_name": "gibbs_telephone",
          "code": "text(\"Let's now run Gibbs sampling:\")  # @clear sample rejection_probs"
        }
      ],
      "env": {
        "sample": null,
        "rejection_probs": null
      },
      "renderings": [
        {
          "type": "markdown",
          "data": "Let's now run Gibbs sampling:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 154,
          "function_name": "gibbs_telephone",
          "code": "text(\"Start with an initialization (full assignment)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Start with an initialization (full assignment)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 155,
          "function_name": "gibbs_telephone",
          "code": "text(\"For each variable X_i, change it based on all other variables\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "For each variable X_i, change it based on all other variables",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 156,
          "function_name": "gibbs_telephone",
          "code": "text(\"- Compute the conditional distribution of X_i given all other variables\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Compute the conditional distribution of X_i given all other variables",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 157,
          "function_name": "gibbs_telephone",
          "code": "text(\"- Sample X_i from this conditional distribution\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Sample X_i from this conditional distribution",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 159,
          "function_name": "gibbs_telephone",
          "code": "text(\"Initialize with an arbitrary sample that satisfies the evidence (D = 1):\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Initialize with an arbitrary sample that satisfies the evidence (D = 1):",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 160,
          "function_name": "gibbs_telephone",
          "code": "x = {\"A\": 1, \"B\": 0, \"C\": 1}  # @inspect x"
        }
      ],
      "env": {
        "x": {
          "type": "dict",
          "contents": {
            "A": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "B": {
              "type": "int",
              "contents": 0,
              "dtype": null,
              "shape": null
            },
            "C": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 162,
          "function_name": "gibbs_telephone",
          "code": "text(\"**Conditional distribution**\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "**Conditional distribution**",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 163,
          "function_name": "gibbs_telephone",
          "code": "text(\"Suppose the goal is to sample B given A = a and C = c.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Suppose the goal is to sample B given A = a and C = c.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 165,
          "function_name": "gibbs_telephone",
          "code": "text(\"Express conditional probability in terms of joint probability:\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Express conditional probability in terms of joint probability:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 166,
          "function_name": "gibbs_telephone",
          "code": "text(\"P(B = b | A = a, C = c) = P(A = a, B = b, C = c) / P(A = a, C = c)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(B = b | A = a, C = c) = P(A = a, B = b, C = c) / P(A = a, C = c)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 168,
          "function_name": "gibbs_telephone",
          "code": "text(\"...with a normalizer which is probability of all other variables we're not sampling\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "...with a normalizer which is probability of all other variables we're not sampling",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 169,
          "function_name": "gibbs_telephone",
          "code": "text(\"P(A = a, C = c) = \u03a3_b P(A = a, B = b, C = c)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(A = a, C = c) = \u03a3_b P(A = a, B = b, C = c)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 171,
          "function_name": "gibbs_telephone",
          "code": "text(\"The joint probability is the product of the local conditional probabilities:\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "The joint probability is the product of the local conditional probabilities:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 172,
          "function_name": "gibbs_telephone",
          "code": "text(\"P(A = a, B = b, C = c) = p(a) p(b | a) p(c | b)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(A = a, B = b, C = c) = p(a) p(b | a) p(c | b)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 173,
          "function_name": "gibbs_telephone",
          "code": "text(\"Note: we don't have to instantiate the entire joint distribution (could be exponentially large).\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Note: we don't have to instantiate the entire joint distribution (could be exponentially large).",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 175,
          "function_name": "gibbs_telephone",
          "code": "def joint_prob(x, var, value):  # @inspect x var value"
        }
      ],
      "env": {
        "x": {
          "type": "dict",
          "contents": {
            "A": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "B": {
              "type": "int",
              "contents": 0,
              "dtype": null,
              "shape": null
            },
            "C": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 183,
          "function_name": "gibbs_telephone",
          "code": "text(\"Note we don't instantiate the joint distribution here.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Note we don't instantiate the joint distribution here.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 184,
          "function_name": "gibbs_telephone",
          "code": "text(\"But we do have to touch every variable (we'll come back to this later).\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "But we do have to touch every variable (we'll come back to this later).",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 186,
          "function_name": "gibbs_telephone",
          "code": "text(\"Let's say we were sampling B \u2208 {0, 1}:\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Let's say we were sampling B \u2208 {0, 1}:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 187,
          "function_name": "gibbs_telephone",
          "code": "p_ab0c = joint_prob(x, \"B\", 0)  # P(A = 1, B = 0, C = 1) @inspect p_ab0c"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 187,
          "function_name": "gibbs_telephone",
          "code": "p_ab0c = joint_prob(x, \"B\", 0)  # P(A = 1, B = 0, C = 1) @inspect p_ab0c"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 175,
          "function_name": "joint_prob",
          "code": "def joint_prob(x, var, value):  # @inspect x var value"
        }
      ],
      "env": {
        "x": {
          "type": "dict",
          "contents": {
            "A": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "B": {
              "type": "int",
              "contents": 0,
              "dtype": null,
              "shape": null
            },
            "C": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        },
        "var": {
          "type": "str",
          "contents": "B",
          "dtype": null,
          "shape": null
        },
        "value": {
          "type": "int",
          "contents": 0,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 187,
          "function_name": "gibbs_telephone",
          "code": "p_ab0c = joint_prob(x, \"B\", 0)  # P(A = 1, B = 0, C = 1) @inspect p_ab0c"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 179,
          "function_name": "joint_prob",
          "code": "y = x | {var: value}  # @inspect y"
        }
      ],
      "env": {
        "y": {
          "type": "dict",
          "contents": {
            "A": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "B": {
              "type": "int",
              "contents": 0,
              "dtype": null,
              "shape": null
            },
            "C": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 187,
          "function_name": "gibbs_telephone",
          "code": "p_ab0c = joint_prob(x, \"B\", 0)  # P(A = 1, B = 0, C = 1) @inspect p_ab0c"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 181,
          "function_name": "joint_prob",
          "code": "return p_a.p[y[\"A\"]] * p_b_given_a.p[y[\"A\"], y[\"B\"]] * p_c_given_b.p[y[\"B\"], y[\"C\"]]"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 187,
          "function_name": "gibbs_telephone",
          "code": "p_ab0c = joint_prob(x, \"B\", 0)  # P(A = 1, B = 0, C = 1) @inspect p_ab0c"
        }
      ],
      "env": {
        "p_ab0c": {
          "type": "numpy.float64",
          "contents": 0.020000000000000004,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 188,
          "function_name": "gibbs_telephone",
          "code": "p_ab1c = joint_prob(x, \"B\", 1)  # P(A = 1, B = 1, C = 1) @inspect p_ab1c"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 188,
          "function_name": "gibbs_telephone",
          "code": "p_ab1c = joint_prob(x, \"B\", 1)  # P(A = 1, B = 1, C = 1) @inspect p_ab1c"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 175,
          "function_name": "joint_prob",
          "code": "def joint_prob(x, var, value):  # @inspect x var value"
        }
      ],
      "env": {
        "x": {
          "type": "dict",
          "contents": {
            "A": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "B": {
              "type": "int",
              "contents": 0,
              "dtype": null,
              "shape": null
            },
            "C": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        },
        "var": {
          "type": "str",
          "contents": "B",
          "dtype": null,
          "shape": null
        },
        "value": {
          "type": "int",
          "contents": 1,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 188,
          "function_name": "gibbs_telephone",
          "code": "p_ab1c = joint_prob(x, \"B\", 1)  # P(A = 1, B = 1, C = 1) @inspect p_ab1c"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 179,
          "function_name": "joint_prob",
          "code": "y = x | {var: value}  # @inspect y"
        }
      ],
      "env": {
        "y": {
          "type": "dict",
          "contents": {
            "A": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "B": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "C": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 188,
          "function_name": "gibbs_telephone",
          "code": "p_ab1c = joint_prob(x, \"B\", 1)  # P(A = 1, B = 1, C = 1) @inspect p_ab1c"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 181,
          "function_name": "joint_prob",
          "code": "return p_a.p[y[\"A\"]] * p_b_given_a.p[y[\"A\"], y[\"B\"]] * p_c_given_b.p[y[\"B\"], y[\"C\"]]"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 188,
          "function_name": "gibbs_telephone",
          "code": "p_ab1c = joint_prob(x, \"B\", 1)  # P(A = 1, B = 1, C = 1) @inspect p_ab1c"
        }
      ],
      "env": {
        "p_ab1c": {
          "type": "numpy.float64",
          "contents": 0.32000000000000006,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 189,
          "function_name": "gibbs_telephone",
          "code": "p_ac = p_ab0c + p_ab1c  # P(A = 1, C = 1) @inspect p_ac"
        }
      ],
      "env": {
        "p_ac": {
          "type": "numpy.float64",
          "contents": 0.3400000000000001,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 190,
          "function_name": "gibbs_telephone",
          "code": "p_b0_given_ac = p_ab0c / p_ac  # P(B = 0 | A = 1, C = 1) @inspect p_b0_given_ac"
        }
      ],
      "env": {
        "p_b0_given_ac": {
          "type": "numpy.float64",
          "contents": 0.058823529411764705,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 191,
          "function_name": "gibbs_telephone",
          "code": "p_b1_given_ac = p_ab1c / p_ac  # P(B = 1 | A = 1, C = 1) @inspect p_b1_given_ac"
        }
      ],
      "env": {
        "p_b1_given_ac": {
          "type": "numpy.float64",
          "contents": 0.9411764705882353,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 192,
          "function_name": "gibbs_telephone",
          "code": "x[\"B\"] = sample_dict({0: p_b0_given_ac, 1: p_b1_given_ac})  # @inspect x"
        }
      ],
      "env": {
        "x": {
          "type": "dict",
          "contents": {
            "A": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "B": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "C": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 193,
          "function_name": "gibbs_telephone",
          "code": "text(\"Note that B gets pulled to 1 because of A=1 and C=1.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Note that B gets pulled to 1 because of A=1 and C=1.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 195,
          "function_name": "gibbs_telephone",
          "code": "text(\"Let's define Gibbs sampling in greater generality:\")  # @clear p_ab0c p_ab1c p_ac p_b0_given_ac p_b1_given_ac x"
        }
      ],
      "env": {
        "p_ab0c": null,
        "p_ab1c": null,
        "p_ac": null,
        "p_b0_given_ac": null,
        "p_b1_given_ac": null,
        "x": null
      },
      "renderings": [
        {
          "type": "markdown",
          "data": "Let's define Gibbs sampling in greater generality:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 319,
          "function_name": "gibbs_sampling",
          "code": "def gibbs_sampling(init_x: dict, vars: list[str], query: Callable, joint_prob: Callable, num_iterations: int) -> dict:"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 326,
          "function_name": "gibbs_sampling",
          "code": "x = dict(init_x)  # Make a copy (good hygiene) @inspect x"
        }
      ],
      "env": {
        "x": {
          "type": "dict",
          "contents": {
            "A": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "B": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "C": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 329,
          "function_name": "gibbs_sampling",
          "code": "counts = defaultdict(int)"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 332,
          "function_name": "gibbs_sampling",
          "code": "for _ in range(num_iterations):"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 333,
          "function_name": "gibbs_sampling",
          "code": "for var in vars:  # @inspect var"
        }
      ],
      "env": {
        "var": {
          "type": "str",
          "contents": "A",
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "gibbs_sampling",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "gibbs_sampling",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "<dictcomp>",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "gibbs_sampling",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "<dictcomp>",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 175,
          "function_name": "joint_prob",
          "code": "def joint_prob(x, var, value):  # @inspect x var value"
        }
      ],
      "env": {
        "x": {
          "type": "dict",
          "contents": {
            "A": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "B": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "C": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        },
        "var": {
          "type": "str",
          "contents": "A",
          "dtype": null,
          "shape": null
        },
        "value": {
          "type": "int",
          "contents": 1,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "gibbs_sampling",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "<dictcomp>",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 179,
          "function_name": "joint_prob",
          "code": "y = x | {var: value}  # @inspect y"
        }
      ],
      "env": {
        "y": {
          "type": "dict",
          "contents": {
            "A": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "B": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "C": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "gibbs_sampling",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "<dictcomp>",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 181,
          "function_name": "joint_prob",
          "code": "return p_a.p[y[\"A\"]] * p_b_given_a.p[y[\"A\"], y[\"B\"]] * p_c_given_b.p[y[\"B\"], y[\"C\"]]"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "gibbs_sampling",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "<dictcomp>",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "gibbs_sampling",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        }
      ],
      "env": {
        "probs": {
          "type": "dict",
          "contents": {
            "0": {
              "type": "numpy.float64",
              "contents": 0.08000000000000002,
              "dtype": null,
              "shape": null
            },
            "1": {
              "type": "numpy.float64",
              "contents": 0.32000000000000006,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 338,
          "function_name": "gibbs_sampling",
          "code": "probs = normalize_dict(probs)  # @inspect probs"
        }
      ],
      "env": {
        "probs": {
          "type": "dict",
          "contents": {
            "0": {
              "type": "numpy.float64",
              "contents": 0.2,
              "dtype": null,
              "shape": null
            },
            "1": {
              "type": "numpy.float64",
              "contents": 0.8,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 341,
          "function_name": "gibbs_sampling",
          "code": "x[var] = sample_dict(probs)  # @inspect x"
        }
      ],
      "env": {
        "x": {
          "type": "dict",
          "contents": {
            "A": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "B": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "C": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 344,
          "function_name": "gibbs_sampling",
          "code": "counts[query(x)] += 1  # @inspect counts"
        }
      ],
      "env": {
        "counts": {
          "type": "collections.defaultdict",
          "contents": {
            "1": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 333,
          "function_name": "gibbs_sampling",
          "code": "for var in vars:  # @inspect var"
        }
      ],
      "env": {
        "var": {
          "type": "str",
          "contents": "B",
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "gibbs_sampling",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "gibbs_sampling",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "<dictcomp>",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "gibbs_sampling",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "<dictcomp>",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 175,
          "function_name": "joint_prob",
          "code": "def joint_prob(x, var, value):  # @inspect x var value"
        }
      ],
      "env": {
        "x": {
          "type": "dict",
          "contents": {
            "A": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "B": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "C": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        },
        "var": {
          "type": "str",
          "contents": "B",
          "dtype": null,
          "shape": null
        },
        "value": {
          "type": "int",
          "contents": 0,
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "gibbs_sampling",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "<dictcomp>",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 179,
          "function_name": "joint_prob",
          "code": "y = x | {var: value}  # @inspect y"
        }
      ],
      "env": {
        "y": {
          "type": "dict",
          "contents": {
            "A": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "B": {
              "type": "int",
              "contents": 0,
              "dtype": null,
              "shape": null
            },
            "C": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "gibbs_sampling",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "<dictcomp>",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 181,
          "function_name": "joint_prob",
          "code": "return p_a.p[y[\"A\"]] * p_b_given_a.p[y[\"A\"], y[\"B\"]] * p_c_given_b.p[y[\"B\"], y[\"C\"]]"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "gibbs_sampling",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "<dictcomp>",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 335,
          "function_name": "gibbs_sampling",
          "code": "probs = {value: joint_prob(x, var, value) for value in [0, 1]}  # value -> P(..., var=value) @inspect probs @stepover"
        }
      ],
      "env": {
        "probs": {
          "type": "dict",
          "contents": {
            "0": {
              "type": "numpy.float64",
              "contents": 0.020000000000000004,
              "dtype": null,
              "shape": null
            },
            "1": {
              "type": "numpy.float64",
              "contents": 0.32000000000000006,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 338,
          "function_name": "gibbs_sampling",
          "code": "probs = normalize_dict(probs)  # @inspect probs"
        }
      ],
      "env": {
        "probs": {
          "type": "dict",
          "contents": {
            "0": {
              "type": "numpy.float64",
              "contents": 0.058823529411764705,
              "dtype": null,
              "shape": null
            },
            "1": {
              "type": "numpy.float64",
              "contents": 0.9411764705882353,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 341,
          "function_name": "gibbs_sampling",
          "code": "x[var] = sample_dict(probs)  # @inspect x"
        }
      ],
      "env": {
        "x": {
          "type": "dict",
          "contents": {
            "A": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "B": {
              "type": "numpy.int64",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "C": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 344,
          "function_name": "gibbs_sampling",
          "code": "counts[query(x)] += 1  # @inspect counts"
        }
      ],
      "env": {
        "counts": {
          "type": "collections.defaultdict",
          "contents": {
            "1": {
              "type": "int",
              "contents": 2,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 333,
          "function_name": "gibbs_sampling",
          "code": "for var in vars:  # @inspect var"
        }
      ],
      "env": {
        "var": {
          "type": "str",
          "contents": "B",
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 332,
          "function_name": "gibbs_sampling",
          "code": "for _ in range(num_iterations):"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 347,
          "function_name": "gibbs_sampling",
          "code": "probs = normalize_dict(counts)  # @inspect probs"
        }
      ],
      "env": {
        "probs": {
          "type": "dict",
          "contents": {
            "1": {
              "type": "float",
              "contents": 1.0,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 349,
          "function_name": "gibbs_sampling",
          "code": "return probs"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 196,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=1)  # @inspect gibbs_probs"
        }
      ],
      "env": {
        "gibbs_probs": {
          "type": "dict",
          "contents": {
            "1": {
              "type": "float",
              "contents": 1.0,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 198,
          "function_name": "gibbs_telephone",
          "code": "text(\"Run Gibbs sampling for multiple iterations:\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Run Gibbs sampling for multiple iterations:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 199,
          "function_name": "gibbs_telephone",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=100)  # @inspect gibbs_probs @stepover"
        }
      ],
      "env": {
        "gibbs_probs": {
          "type": "dict",
          "contents": {
            "1": {
              "type": "float",
              "contents": 0.68,
              "dtype": null,
              "shape": null
            },
            "0": {
              "type": "float",
              "contents": 0.32,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 201,
          "function_name": "gibbs_telephone",
          "code": "text(\"Comparing with rejection sampling, both are in the ballpark.\") # @inspect rejection_probs"
        }
      ],
      "env": {
        "rejection_probs": {
          "type": "dict",
          "contents": {
            "1": {
              "type": "float",
              "contents": 0.6530612244897959,
              "dtype": null,
              "shape": null
            },
            "0": {
              "type": "float",
              "contents": 0.3469387755102041,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": [
        {
          "type": "markdown",
          "data": "Comparing with rejection sampling, both are in the ballpark.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 203,
          "function_name": "gibbs_telephone",
          "code": "text(\"Running time: O(#iterations * #variables * |domain| * #variables)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Running time: O(#iterations * #variables * |domain| * #variables)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 205,
          "function_name": "gibbs_telephone",
          "code": "text(\"Summary:\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Summary:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 206,
          "function_name": "gibbs_telephone",
          "code": "text(\"- Update one variable at a time using its conditional distribution given all other variables\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Update one variable at a time using its conditional distribution given all other variables",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 207,
          "function_name": "gibbs_telephone",
          "code": "text(\"- Compute the conditional distribution using the joint distribution\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Compute the conditional distribution using the joint distribution",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 208,
          "function_name": "gibbs_telephone",
          "code": "text(\"- Only have to sum over domain of the variable we're sampling\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Only have to sum over domain of the variable we're sampling",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 210,
          "function_name": "gibbs_telephone",
          "code": "text(\"Can we be even more efficient and not touch variables we're not sampling?\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Can we be even more efficient and not touch variables we're not sampling?",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 113,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_telephone()              # Gibbs sampling on a telephone example"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 213,
          "function_name": "markov_blanket",
          "code": "def markov_blanket():"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 214,
          "function_name": "markov_blanket",
          "code": "text(\"Joint probability: p(a) p(b | a) p(c | b) p(d | c) p(e | d)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Joint probability: p(a) p(b | a) p(c | b) p(d | c) p(e | d)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 215,
          "function_name": "markov_blanket",
          "code": "text(\"Can we avoid having to compute the full joint probability every time we sample a variable?\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Can we avoid having to compute the full joint probability every time we sample a variable?",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 216,
          "function_name": "markov_blanket",
          "code": "text(\"Intuitively, only one variable changes...\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Intuitively, only one variable changes...",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 218,
          "function_name": "markov_blanket",
          "code": "text(\"Recall the telephone Bayesian network: A \u2192 B \u2192 C\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Recall the telephone Bayesian network: A \u2192 B \u2192 C",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 219,
          "function_name": "markov_blanket",
          "code": "p_a = ProbTable(\"A\", [0.5, 0.5]) # p(a) @inspect p_a @stepover"
        }
      ],
      "env": {
        "p_a": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "a",
              "P(A=a)"
            ],
            [
              "0",
              "0.5"
            ],
            [
              "1",
              "0.5"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            3,
            2
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 220,
          "function_name": "markov_blanket",
          "code": "p_b_given_a = ProbTable(\"B | A\", lambda a, b: 0.8 if b == a else 0.2, shape=(2, 2))  # p(b | a) @inspect p_b_given_a @stepover"
        }
      ],
      "env": {
        "p_b_given_a": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "a",
              "b",
              "P(B=b | A=a)"
            ],
            [
              "0",
              "0",
              "0.8"
            ],
            [
              "0",
              "1",
              "0.2"
            ],
            [
              "1",
              "0",
              "0.2"
            ],
            [
              "1",
              "1",
              "0.8"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            5,
            3
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 221,
          "function_name": "markov_blanket",
          "code": "p_c_given_b = ProbTable(\"C | B\", lambda b, c: 0.8 if c == b else 0.2, shape=(2, 2))  # p(c | b) @inspect p_c_given_b @stepover"
        }
      ],
      "env": {
        "p_c_given_b": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "b",
              "c",
              "P(C=c | B=b)"
            ],
            [
              "0",
              "0",
              "0.8"
            ],
            [
              "0",
              "1",
              "0.2"
            ],
            [
              "1",
              "0",
              "0.2"
            ],
            [
              "1",
              "1",
              "0.8"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            5,
            3
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 223,
          "function_name": "markov_blanket",
          "code": "text(\"Suppose we're sampling P(A | B = b, C = c)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Suppose we're sampling P(A | B = b, C = c)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 224,
          "function_name": "markov_blanket",
          "code": "text(\"Let's look at the joint distribution:\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Let's look at the joint distribution:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 225,
          "function_name": "markov_blanket",
          "code": "text(\"P(A = 0, B = b, C = c) = p(a = 0) p(b | a = 0) p(c | b)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(A = 0, B = b, C = c) = p(a = 0) p(b | a = 0) p(c | b)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 226,
          "function_name": "markov_blanket",
          "code": "text(\"P(A = 1, B = b, C = c) = p(a = 1) p(b | a = 1) p(c | b)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(A = 1, B = b, C = c) = p(a = 1) p(b | a = 1) p(c | b)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 227,
          "function_name": "markov_blanket",
          "code": "text(\"P(B = b, C = c) = \u03a3_a p(a) p(b | a) p(c | b)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(B = b, C = c) = \u03a3_a p(a) p(b | a) p(c | b)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 228,
          "function_name": "markov_blanket",
          "code": "text(\"Notice that p(c | b) shows up in both cases, and does not impact P(A | B = b, C = c).\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Notice that p(c | b) shows up in both cases, and does not impact P(A | B = b, C = c).",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 229,
          "function_name": "markov_blanket",
          "code": "text(\"So we can just ignore it!\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "So we can just ignore it!",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 231,
          "function_name": "markov_blanket",
          "code": "text(\"In general, we need to only include variables that touch the variable we're sampling.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "In general, we need to only include variables that touch the variable we're sampling.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 232,
          "function_name": "markov_blanket",
          "code": "text(\"This set of variables is called the **Markov blanket**.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "This set of variables is called the **Markov blanket**.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 233,
          "function_name": "markov_blanket",
          "code": "text(\"The Markov blanket of a variable is all its children and parents.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "The Markov blanket of a variable is all its children and parents.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 234,
          "function_name": "markov_blanket",
          "code": "text(\"MarkovBlanket(A) = {B}\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "MarkovBlanket(A) = {B}",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 235,
          "function_name": "markov_blanket",
          "code": "text(\"MarkovBlanket(B) = {A, C}\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "MarkovBlanket(B) = {A, C}",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 236,
          "function_name": "markov_blanket",
          "code": "text(\"MarkovBlanket(C) = {B}\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "MarkovBlanket(C) = {B}",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 238,
          "function_name": "markov_blanket",
          "code": "text(\"Instead of computing the joint probability\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Instead of computing the joint probability",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 239,
          "function_name": "markov_blanket",
          "code": "text(\"...let us just include the variables in the Markov blanket.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "...let us just include the variables in the Markov blanket.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 240,
          "function_name": "markov_blanket",
          "code": "def markov_prob(x, var, value):"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 249,
          "function_name": "markov_blanket",
          "code": "text(\"Now we can run Gibbs sampling with the Markov blanket:\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Now we can run Gibbs sampling with the Markov blanket:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 250,
          "function_name": "markov_blanket",
          "code": "x = {\"A\": 0, \"B\": 0, \"C\": 1}"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 251,
          "function_name": "markov_blanket",
          "code": "query = lambda sample: sample[\"A\"]"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 252,
          "function_name": "markov_blanket",
          "code": "probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=markov_prob, num_iterations=100)  # @inspect probs @stepover"
        }
      ],
      "env": {
        "probs": {
          "type": "dict",
          "contents": {
            "0": {
              "type": "float",
              "contents": 0.37,
              "dtype": null,
              "shape": null
            },
            "1": {
              "type": "float",
              "contents": 0.63,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 254,
          "function_name": "markov_blanket",
          "code": "text(\"Running time with joint_prob: O(#iterations * #variables * |domain| * #variables)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Running time with joint_prob: O(#iterations * #variables * |domain| * #variables)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 255,
          "function_name": "markov_blanket",
          "code": "text(\"Running time with markov_prob: O(#iterations * #variables * |domain| * **|markov_blanket|**)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Running time with markov_prob: O(#iterations * #variables * |domain| * **|markov_blanket|**)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 257,
          "function_name": "markov_blanket",
          "code": "text(\"Summary:\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Summary:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 258,
          "function_name": "markov_blanket",
          "code": "text(\"- Markov blanket of a node: all its children and parents\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Markov blanket of a node: all its children and parents",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 259,
          "function_name": "markov_blanket",
          "code": "text(\"- Gibbs sampling requires local conditional probabilities of node and its Markov blanket\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Gibbs sampling requires local conditional probabilities of node and its Markov blanket",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 260,
          "function_name": "markov_blanket",
          "code": "text(\"- Much more efficient if Markov blankets are small\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Much more efficient if Markov blankets are small",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 114,
          "function_name": "introduce_gibbs_sampling",
          "code": "markov_blanket()               # Introduce the Markov blanket to speed things up"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 115,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_alarm()                  # Gibbs sampling on the alarm Bayesian network"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 115,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_alarm()                  # Gibbs sampling on the alarm Bayesian network"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 263,
          "function_name": "gibbs_alarm",
          "code": "def gibbs_alarm():"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 115,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_alarm()                  # Gibbs sampling on the alarm Bayesian network"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 264,
          "function_name": "gibbs_alarm",
          "code": "text(\"Let's now run Gibbs sampling on the alarm Bayesian network.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Let's now run Gibbs sampling on the alarm Bayesian network.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 115,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_alarm()                  # Gibbs sampling on the alarm Bayesian network"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 266,
          "function_name": "gibbs_alarm",
          "code": "image(\"images/alarm-bayes.png\", width=200)"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "image",
          "data": "images/alarm-bayes.png",
          "style": {
            "width": 200
          },
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 115,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_alarm()                  # Gibbs sampling on the alarm Bayesian network"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 267,
          "function_name": "gibbs_alarm",
          "code": "p_b = ProbTable(\"B\", [0.95, 0.05]) # p(b) @inspect p_b @stepover"
        }
      ],
      "env": {
        "p_b": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "b",
              "P(B=b)"
            ],
            [
              "0",
              "0.95"
            ],
            [
              "1",
              "0.05"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            3,
            2
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 115,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_alarm()                  # Gibbs sampling on the alarm Bayesian network"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 268,
          "function_name": "gibbs_alarm",
          "code": "p_e = ProbTable(\"E\", [0.95, 0.05]) # p(e) @inspect p_e @stepover"
        }
      ],
      "env": {
        "p_e": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "e",
              "P(E=e)"
            ],
            [
              "0",
              "0.95"
            ],
            [
              "1",
              "0.05"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            3,
            2
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 115,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_alarm()                  # Gibbs sampling on the alarm Bayesian network"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 269,
          "function_name": "gibbs_alarm",
          "code": "p_a_given_be = ProbTable(\"A | B E\", lambda b, e, a: a == (b or e), shape=(2, 2, 2)) # p(a | b, e) @inspect p_a_given_be @stepover"
        }
      ],
      "env": {
        "p_a_given_be": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "b",
              "e",
              "a",
              "P(A=a | B=b, E=e)"
            ],
            [
              "0",
              "0",
              "0",
              "1.0"
            ],
            [
              "0",
              "0",
              "1",
              "0.0"
            ],
            [
              "0",
              "1",
              "0",
              "0.0"
            ],
            [
              "0",
              "1",
              "1",
              "1.0"
            ],
            [
              "1",
              "0",
              "0",
              "0.0"
            ],
            [
              "1",
              "0",
              "1",
              "1.0"
            ],
            [
              "1",
              "1",
              "0",
              "0.0"
            ],
            [
              "1",
              "1",
              "1",
              "1.0"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            9,
            4
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 115,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_alarm()                  # Gibbs sampling on the alarm Bayesian network"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 272,
          "function_name": "gibbs_alarm",
          "code": "x = {\"B\": 1, \"E\": 1, \"A\": 1}  # @inspect x"
        }
      ],
      "env": {
        "x": {
          "type": "dict",
          "contents": {
            "B": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "E": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            },
            "A": {
              "type": "int",
              "contents": 1,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 115,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_alarm()                  # Gibbs sampling on the alarm Bayesian network"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 275,
          "function_name": "gibbs_alarm",
          "code": "def compute_prob(x, var, value):"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 115,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_alarm()                  # Gibbs sampling on the alarm Bayesian network"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 280,
          "function_name": "gibbs_alarm",
          "code": "query = lambda sample: sample[\"B\"]"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 115,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_alarm()                  # Gibbs sampling on the alarm Bayesian network"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 283,
          "function_name": "gibbs_alarm",
          "code": "probs = gibbs_sampling(x, vars=[\"B\", \"E\"], query=query, joint_prob=compute_prob, num_iterations=100)  # @inspect probs @stepover"
        }
      ],
      "env": {
        "probs": {
          "type": "dict",
          "contents": {
            "0": {
              "type": "float",
              "contents": 0.35,
              "dtype": null,
              "shape": null
            },
            "1": {
              "type": "float",
              "contents": 0.65,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 115,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_alarm()                  # Gibbs sampling on the alarm Bayesian network"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 284,
          "function_name": "gibbs_alarm",
          "code": "probs = gibbs_sampling(x, vars=[\"B\", \"E\"], query=query, joint_prob=compute_prob, num_iterations=200)  # @inspect probs @stepover"
        }
      ],
      "env": {
        "probs": {
          "type": "dict",
          "contents": {
            "0": {
              "type": "float",
              "contents": 0.665,
              "dtype": null,
              "shape": null
            },
            "1": {
              "type": "float",
              "contents": 0.335,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 115,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_alarm()                  # Gibbs sampling on the alarm Bayesian network"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 286,
          "function_name": "gibbs_alarm",
          "code": "text(\"Note that the estimates aren't quite accurate...\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Note that the estimates aren't quite accurate...",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 115,
          "function_name": "introduce_gibbs_sampling",
          "code": "gibbs_alarm()                  # Gibbs sampling on the alarm Bayesian network"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 289,
          "function_name": "compare_gibbs_and_rejection",
          "code": "def compare_gibbs_and_rejection():"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 290,
          "function_name": "compare_gibbs_and_rejection",
          "code": "text(\"What examples are hard for rejection sampling?\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "What examples are hard for rejection sampling?",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 291,
          "function_name": "compare_gibbs_and_rejection",
          "code": "text(\"Answer: when evidence has low probability.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Answer: when evidence has low probability.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 292,
          "function_name": "compare_gibbs_and_rejection",
          "code": "text(\"A \u2192 B\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "A \u2192 B",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 293,
          "function_name": "compare_gibbs_and_rejection",
          "code": "p_a = ProbTable(\"A\", [0.5, 0.5]) # p(a) @inspect p_a @stepover"
        }
      ],
      "env": {
        "p_a": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "a",
              "P(A=a)"
            ],
            [
              "0",
              "0.5"
            ],
            [
              "1",
              "0.5"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            3,
            2
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 294,
          "function_name": "compare_gibbs_and_rejection",
          "code": "p_b_given_a = ProbTable(\"B | A\", [[0.9999, 0.0001], [0.9998, 0.0002]])  # p(b | a) @inspect p_b_given_a @stepover"
        }
      ],
      "env": {
        "p_b_given_a": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "a",
              "b",
              "P(B=b | A=a)"
            ],
            [
              "0",
              "0",
              "0.9999"
            ],
            [
              "0",
              "1",
              "0.0001"
            ],
            [
              "1",
              "0",
              "0.9998"
            ],
            [
              "1",
              "1",
              "0.0002"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            5,
            3
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 295,
          "function_name": "compare_gibbs_and_rejection",
          "code": "text(\"Compute P(A | B = 1)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Compute P(A | B = 1)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 296,
          "function_name": "compare_gibbs_and_rejection",
          "code": "text(\"Reason: need to reject all samples that don't match the evidence.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Reason: need to reject all samples that don't match the evidence.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 297,
          "function_name": "compare_gibbs_and_rejection",
          "code": "text(\"Gibbs sample conditions on B = 1, so will work fine.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Gibbs sample conditions on B = 1, so will work fine.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 299,
          "function_name": "compare_gibbs_and_rejection",
          "code": "text(\"What examples are hard for Gibbs sampling?\")  # @clear p_a p_b_given_a"
        }
      ],
      "env": {
        "p_a": null,
        "p_b_given_a": null
      },
      "renderings": [
        {
          "type": "markdown",
          "data": "What examples are hard for Gibbs sampling?",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 300,
          "function_name": "compare_gibbs_and_rejection",
          "code": "text(\"Answer: when variables are highly correlated.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Answer: when variables are highly correlated.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 301,
          "function_name": "compare_gibbs_and_rejection",
          "code": "text(\"A \u2192 B\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "A \u2192 B",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 302,
          "function_name": "compare_gibbs_and_rejection",
          "code": "p_a = ProbTable(\"A\", [0.5, 0.5]) # p(a) @inspect p_a @stepover"
        }
      ],
      "env": {
        "p_a": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "a",
              "P(A=a)"
            ],
            [
              "0",
              "0.5"
            ],
            [
              "1",
              "0.5"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            3,
            2
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 303,
          "function_name": "compare_gibbs_and_rejection",
          "code": "p_b_given_a = ProbTable(\"B | A\", lambda a, b: a == b, shape=(2, 2))  # p(b | a) @inspect p_b_given_a @stepover"
        }
      ],
      "env": {
        "p_b_given_a": {
          "type": "numpy.ndarray",
          "contents": [
            [
              "a",
              "b",
              "P(B=b | A=a)"
            ],
            [
              "0",
              "0",
              "1.0"
            ],
            [
              "0",
              "1",
              "0.0"
            ],
            [
              "1",
              "0",
              "0.0"
            ],
            [
              "1",
              "1",
              "1.0"
            ]
          ],
          "dtype": "<U32",
          "shape": [
            5,
            3
          ]
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 304,
          "function_name": "compare_gibbs_and_rejection",
          "code": "text(\"Probabilistic inference: P(A) [no evidence]\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Probabilistic inference: P(A) [no evidence]",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 305,
          "function_name": "compare_gibbs_and_rejection",
          "code": "x = {\"A\": 0, \"B\": 0}"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 306,
          "function_name": "compare_gibbs_and_rejection",
          "code": "text(\"Rejection sampling generates from scratch every time, so works perfectly (no rejection).\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Rejection sampling generates from scratch every time, so works perfectly (no rejection).",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 307,
          "function_name": "compare_gibbs_and_rejection",
          "code": "text(\"Gibbs sampling gets stuck and will not explore A = 1.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Gibbs sampling gets stuck and will not explore A = 1.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 308,
          "function_name": "compare_gibbs_and_rejection",
          "code": "query = lambda sample: sample[\"A\"]"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 309,
          "function_name": "compare_gibbs_and_rejection",
          "code": "def joint_prob(x, var, value):"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 312,
          "function_name": "compare_gibbs_and_rejection",
          "code": "gibbs_probs = gibbs_sampling(x, vars=[\"A\", \"B\"], query=query, joint_prob=joint_prob, num_iterations=50)  # @inspect gibbs_probs @stepover"
        }
      ],
      "env": {
        "gibbs_probs": {
          "type": "dict",
          "contents": {
            "0": {
              "type": "float",
              "contents": 1.0,
              "dtype": null,
              "shape": null
            }
          },
          "dtype": null,
          "shape": null
        }
      },
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 314,
          "function_name": "compare_gibbs_and_rejection",
          "code": "text(\"Summary:\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Summary:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 315,
          "function_name": "compare_gibbs_and_rejection",
          "code": "text(\"- Rare events are hard for rejection sampling\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Rare events are hard for rejection sampling",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 316,
          "function_name": "compare_gibbs_and_rejection",
          "code": "text(\"- Highly correlated variables are hard for Gibbs sampling\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Highly correlated variables are hard for Gibbs sampling",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 116,
          "function_name": "introduce_gibbs_sampling",
          "code": "compare_gibbs_and_rejection()  # When does it work versus rejection sampling?"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 118,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"Further reading:\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Further reading:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 119,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"- Gibbs sampling is an example of a Markov chain Monte Carlo (MCMC) algorithm.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Gibbs sampling is an example of a Markov chain Monte Carlo (MCMC) algorithm.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 120,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"- A more general MCMC algorithm is Metropolis-Hastings (uses a proposal distribution).\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- A more general MCMC algorithm is Metropolis-Hastings (uses a proposal distribution).",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 121,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"- Theory: use mixing times to study effective running time (how correlated samples are)?\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Theory: use mixing times to study effective running time (how correlated samples are)?",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 122,
          "function_name": "introduce_gibbs_sampling",
          "code": "text(\"- Practice: simple and effective, but can be slow\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Practice: simple and effective, but can be slow",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 16,
          "function_name": "main",
          "code": "introduce_gibbs_sampling()"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 352,
          "function_name": "introduce_conditional_independence",
          "code": "def introduce_conditional_independence():"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 353,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"So far: can do probabilistic inference on Bayesian networks\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "So far: can do probabilistic inference on Bayesian networks",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 354,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"They have been fairly agnostic to the structure of the Bayesian network.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "They have been fairly agnostic to the structure of the Bayesian network.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 355,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"Now: let's explore some properties of the Bayesian network.\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Now: let's explore some properties of the Bayesian network.",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 356,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"We will connect graph properties to probabilistic properties (in particularly independence).\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "We will connect graph properties to probabilistic properties (in particularly independence).",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 358,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"**Independence**\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "**Independence**",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 359,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"Two variables A and B are independent iff:\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Two variables A and B are independent iff:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 360,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"P(A = a, B = b) = P(A = a) P(B = b) for all a, b\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(A = a, B = b) = P(A = a) P(B = b) for all a, b",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 362,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"Example 1 (A B):\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Example 1 (A B):",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 363,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"P(A = a, B = b) = p(a) p(b)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(A = a, B = b) = p(a) p(b)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 364,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"A and B are independent\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "A and B are independent",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 366,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"Example 2 (A \u2192 B):\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Example 2 (A \u2192 B):",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 367,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"P(A = a, B = b) = p(a) p(b | a)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(A = a, B = b) = p(a) p(b | a)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 368,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"A and B are not independent\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "A and B are not independent",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 370,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"Example 3 (A, B \u2192 C):\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Example 3 (A, B \u2192 C):",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 371,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"P(A = a, B = b, C = c) = p(a) p(b | a) p(c | b, a)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(A = a, B = b, C = c) = p(a) p(b | a) p(c | b, a)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 372,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"P(A = a, B = b) = \u03a3_c P(A = a, B = b, C = c) = \u03a3_c p(a) p(b) p(c | b, a) = p(a) p(b)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(A = a, B = b) = \u03a3_c P(A = a, B = b, C = c) = \u03a3_c p(a) p(b) p(c | b, a) = p(a) p(b)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 373,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"A and B are independent (even if they are connected)!\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "A and B are independent (even if they are connected)!",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 375,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"Example 4 (C \u2192 A, B):\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Example 4 (C \u2192 A, B):",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 376,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"P(A = a, B = b, C = c) = p(c) p(a | c) p(b | c)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(A = a, B = b, C = c) = p(c) p(a | c) p(b | c)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 377,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"P(A = a, B = b) = \u03a3_c P(A = a, B = b, C = c) = \u03a3_c p(c) p(a | c) p(b | c)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(A = a, B = b) = \u03a3_c P(A = a, B = b, C = c) = \u03a3_c p(c) p(a | c) p(b | c)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 378,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"A and B are not independent!\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "A and B are not independent!",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 380,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"**Conditional independence**\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "**Conditional independence**",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 381,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"Two variables A and B are conditionally independent given C = c iff:\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Two variables A and B are conditionally independent given C = c iff:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 382,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"P(A = a, B = b | C = c) = P(A = a | C = c) P(B = b | C = c) for all a, b\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(A = a, B = b | C = c) = P(A = a | C = c) P(B = b | C = c) for all a, b",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 384,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"Example 4 again (C \u2192 A, B):\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Example 4 again (C \u2192 A, B):",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 385,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"P(A = a, B = b | C = c) = p(c) p(a | c) p(b | c) / p(c) = p(a | c) p(b | c)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(A = a, B = b | C = c) = p(c) p(a | c) p(b | c) / p(c) = p(a | c) p(b | c)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 386,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"A and B are conditionally independent given C = c\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "A and B are conditionally independent given C = c",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 388,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"Example 3 again (A, B \u2192 C):\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Example 3 again (A, B \u2192 C):",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 389,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"P(A = a, B = b | C = c) = p(a) p(b) p(c | a, b)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "P(A = a, B = b | C = c) = p(a) p(b) p(c | a, b)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 390,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"A and B are not conditionally independent given C = c\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "A and B are not conditionally independent given C = c",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 392,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"**Alarm example**\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "**Alarm example**",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 393,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"Variables: Burglary B, Earthquake E, Alarm A\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Variables: Burglary B, Earthquake E, Alarm A",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 394,
          "function_name": "introduce_conditional_independence",
          "code": "image(\"images/alarm-bayes.png\", width=200)"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "image",
          "data": "images/alarm-bayes.png",
          "style": {
            "width": 200
          },
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 395,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"B and E are independent\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "B and E are independent",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 396,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"B and E are not conditionally independent given A = 1\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "B and E are not conditionally independent given A = 1",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 398,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"**General algorithm**\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "**General algorithm**",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 399,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"Question: are A and B independent given C?\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Question: are A and B independent given C?",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 400,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"1. Shade in the variables C\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "1. Shade in the variables C",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 401,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"2. Recursively remove any non-shaded leaves\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "2. Recursively remove any non-shaded leaves",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 402,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"3. Connect parents to each other (marriage)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "3. Connect parents to each other (marriage)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 403,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"3. Return whether there is a path from A to B that doesn't go through any shaded nodes\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "3. Return whether there is a path from A to B that doesn't go through any shaded nodes",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 405,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"**Medical diagnosis example**\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "**Medical diagnosis example**",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 406,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"Variables: Cold C, Allergies A, Cough H, Itchy eyes I\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Variables: Cold C, Allergies A, Cough H, Itchy eyes I",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 407,
          "function_name": "introduce_conditional_independence",
          "code": "image(\"images/medical-bayes.png\", width=200)"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "image",
          "data": "images/medical-bayes.png",
          "style": {
            "width": 200
          },
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 408,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"C and A are independent\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "C and A are independent",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 409,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"C and I are independent\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "C and I are independent",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 410,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"C and H are independent given A\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "C and H are independent given A",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 411,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"C and I are independent given A\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "C and I are independent given A",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        },
        {
          "path": "gibbs_sampling.py",
          "line_number": 412,
          "function_name": "introduce_conditional_independence",
          "code": "text(\"C and I are independent given H, A\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "C and I are independent given H, A",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 17,
          "function_name": "main",
          "code": "introduce_conditional_independence()"
        }
      ],
      "env": {},
      "renderings": []
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 19,
          "function_name": "main",
          "code": "text(\"Summary:\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Summary:",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 20,
          "function_name": "main",
          "code": "text(\"- Exact probabilistic inference: form the joint distribution and marginalize/condition (einops)\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Exact probabilistic inference: form the joint distribution and marginalize/condition (einops)",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 21,
          "function_name": "main",
          "code": "text(\"- Approximate probabilistic inference: rejection sampling, Gibbs sampling\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Approximate probabilistic inference: rejection sampling, Gibbs sampling",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 22,
          "function_name": "main",
          "code": "text(\"- Conditional independence: determine whether two variables are independent given evidence?\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "- Conditional independence: determine whether two variables are independent given evidence?",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    },
    {
      "stack": [
        {
          "path": "gibbs_sampling.py",
          "line_number": 24,
          "function_name": "main",
          "code": "text(\"Next time: learning parameters of Bayesian networks\")"
        }
      ],
      "env": {},
      "renderings": [
        {
          "type": "markdown",
          "data": "Next time: learning parameters of Bayesian networks",
          "style": {},
          "external_link": null,
          "internal_link": null
        }
      ]
    }
  ]
}